<html>
<head>
<title>Getting started with RabbitMQ in Spring Boot</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Spring Boot rabbit MQå…¥é—¨</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/javarevisited/getting-started-with-rabbitmq-in-spring-boot-6323b9179247?source=collection_archive---------0-----------------------#2022-04-09">https://medium.com/javarevisited/getting-started-with-rabbitmq-in-spring-boot-6323b9179247?source=collection_archive---------0-----------------------#2022-04-09</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/f58608a5aa16e186b9e3231a1f115dbe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TPQzjC2Q5mEIe4kBcPprfg.jpeg"/></div></div><p class="iq ir et er es is it bd b be z dx translated">è¿™åªæ˜¯æˆ‘å‡ºäºå®¡ç¾ç›®çš„æ‹æ‘„çš„ä¸€å¼ ç…§ç‰‡ï¼Œ:D</p></figure><p id="7bec" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">RabbitMQæ˜¯éƒ¨ç½²æœ€å¹¿æ³›çš„å¼€æºæ¶ˆæ¯ä»£ç†ã€‚å®ƒä¸ºæ‚¨æä¾›äº†ä¸€äº›å¾ˆå¥½çš„ç‰¹æ€§ï¼Œå¸®åŠ©æ‚¨ä½¿æ‚¨çš„åº”ç”¨ç¨‹åºå¼‚æ­¥ï¼Œå¹¶å¸è½½ä¸€äº›å…³é”®é€»è¾‘ï¼Œä»¥ä¾¿æ‚¨å¯ä»¥ä¸“æ³¨äºæ‚¨çš„ä¸šåŠ¡ä»£ç ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å·²ç»å±•ç¤ºäº†åœ¨<a class="ae js" rel="noopener" href="/javarevisited/10-best-java-microservices-courses-with-spring-boot-and-spring-cloud-6d04556bdfed?source=rss-bb36d8439904------2&amp;utm_source=dlvr.it&amp;utm_medium=linkedin"> spring booté¡¹ç›®</a>ä¸­å¼€å§‹ä½¿ç”¨RabbitMQã€è‡ªåŠ¨åˆ›å»ºé˜Ÿåˆ—å’Œäº¤æ¢ã€åœ¨æ¶ˆè´¹è€…ä¸Šé…ç½®é‡è¯•èƒ½åŠ›ã€å¤„ç†é”™è¯¯å’Œåˆ†å¸ƒå¼è·Ÿè¸ªçš„æœ€ç®€å•æ–¹æ³•ã€‚</p><p id="8c65" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">æˆ‘æ¥åˆ†äº«ä¸€ä¸ªæç¬‘çš„äº‹ä»¶ã€‚å½“æˆ‘ç¬¬ä¸€æ¬¡å¼€å§‹ä½¿ç”¨rabbitMQæ—¶ï¼Œæˆ‘å»äº†ç½‘ç«™ï¼Œå‘ç°äº†é‚£ä¸ª<a class="ae js" href="https://www.rabbitmq.com/getstarted.html" rel="noopener ugc nofollow" target="_blank">æ•™ç¨‹</a>é¡µé¢ã€‚åœ¨é‚£ä¸ªé¡µé¢ä¸Šæœ‰6ä¸ªä¸åŒè¯­è¨€çš„å¸¸è§åœºæ™¯çš„æ•™ç¨‹ã€‚å˜¿ï¼Javaæ•™ç¨‹å°±åœ¨pythonä¸‹é¢ã€‚å®ƒçœ‹èµ·æ¥è¿˜æ˜¯ä¸€æ ·çš„â€¦</p><figure class="ju jv jw jx fd ij er es paragraph-image"><a href="https://javarevisited.blogspot.com/2014/03/top-10-websphere-mq-series-interview-questions-answers-active-rabbit.html"><div class="er es jt"><img src="../Images/dd815f3bc658f50935506af379f971c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*SvCZA53AJkkYysrj"/></div></a></figure><p id="3ed0" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">ç„¶åæˆ‘æµè§ˆäº†å‡ é¡µjavaæ•™ç¨‹ï¼ŒæƒŠè®¶äºå®ƒçš„æ˜“ç”¨æ€§ã€‚åªéœ€è¦åˆ›å»ºä¸€ä¸ªè¿æ¥å·¥å‚ï¼Œå£°æ˜é€šé“ï¼Œç”¨channels basicPublishæ–¹æ³•å‘å¸ƒï¼Œç”¨deliveryå›è°ƒæ¥æ”¶ã€‚</p><p id="02d5" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">æ˜¯çš„ï¼Œè¿™äº›æ­¥éª¤å¸®åŠ©æˆ‘æ•´åˆäº†æˆ‘çš„ç”¨ä¾‹ï¼Œç”šè‡³å°†æˆ‘çš„åº”ç”¨ç¨‹åºéƒ¨ç½²åˆ°ç”Ÿäº§ä¸­ã€‚ç„¶ååœ¨å¦ä¸€ä¸ªé¡¹ç›®ä¸­ï¼Œæˆ‘ä¹Ÿä»¥è¿™ç§æ–¹å¼å¼€å§‹ï¼Œåœ¨æˆ‘è„‘æµ·ä¸­çš„æŸä¸ªåœ°æ–¹ï¼Œæˆ‘ä¸æ–­å¬åˆ°ä¸€ä¸ªå£°éŸ³..â€œåº”è¯¥æœ‰æ›´å¹²å‡€çš„åŠæ³•ï¼ï¼Œåº”è¯¥æœ‰æ›´å¥½çš„åŠæ³•ï¼!"ã€‚ç›¸ä¿¡æˆ‘ï¼Œæ›´å¥½çš„æ–¹æ³•æ€»æ˜¯åœ¨æˆ‘çœ¼å‰ï¼Œä½†æˆ‘å´çœ‹ä¸è§ã€‚åœ¨åŒä¸€ä¸ªæ•™ç¨‹é¡µé¢ä¸Šæœ‰â€¦</p><figure class="ju jv jw jx fd ij er es paragraph-image"><a href="https://javarevisited.blogspot.com/2020/05/top-16-jms-java-messaging-service-interview-questions-answers.html"><div class="er es jt"><img src="../Images/e0b31b9067d5d77d0fcb6f4fbeb05eb3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Lywixs1ydMhucNEj"/></div></a></figure><p id="6956" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">æ¯ä¸ªæ•™ç¨‹çš„æ˜¥å­£AMQP </strong>ç‰ˆæœ¬æ­£æ˜¯æˆ‘æ‰€éœ€è¦çš„ï¼Œä½†ä»æ¥ä¸çŸ¥é“å®ƒçš„å­˜åœ¨ã€‚</p><p id="991d" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><a class="ae js" href="https://spring.io/projects/spring-amqp" rel="noopener ugc nofollow" target="_blank"> Spring AMQP </a>è®©RabbitMQçš„å¼€å‘æ›´æœ‰å¼¹æ€§ã€‚å®ƒæä¾›äº†ç›‘å¬å™¨å®¹å™¨ã€rabbitTemplateå’ŒrabbitAdminã€‚æ‰€ä»¥è®©æˆ‘ä»¬æ¥çœ‹çœ‹ä¸€äº›è¡ŒåŠ¨å§ï¼</p><h1 id="1a71" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">è®¾ç½®RabbitMQ</h1><p id="425b" class="pw-post-body-paragraph iu iv hi iw b ix kw iz ja jb kx jd je jf ky jh ji jj kz jl jm jn la jp jq jr hb bi translated">å› æ­¤ï¼Œåœ¨åšä»»ä½•äº‹æƒ…ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦æœ‰ä¸€ä¸ªRabbitMQå®ä¾‹è¿è¡Œï¼Œä»¥ä¾¿ä¸å®ƒè¿›è¡Œäº¤äº’ï¼Œå¦‚æœæ‚¨æ²¡æœ‰è¿™æ ·çš„å®ä¾‹çš„è¯ã€‚ä½ å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„docker composeå¿«é€Ÿå¾—åˆ°ä¸€ä¸ªã€‚</p><pre class="ju jv jw jx fd lb lc ld le aw lf bi"><span id="c76f" class="lg jz hi lc b fi lh li l lj lk">version: '3.1'<br/><br/>services:<br/> rabbitmq:<br/>   image: rabbitmq:management<br/>   restart: no<br/>   ports:<br/>     - "5672:5672"<br/>     - "15672:15672"</span></pre><p id="709f" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">è¿™é‡Œ5672ç«¯å£ç”±åº”ç”¨ç¨‹åºä½¿ç”¨ï¼Œåœ¨15672ä¸Šæˆ‘ä»¬å¾—åˆ°ä¸€ä¸ªç”¨äºç®¡ç†çš„webç•Œé¢ã€‚</p><p id="1bdf" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">æ‰“å¼€ä½ çš„æµè§ˆå™¨ï¼Œç‚¹å‡»localhost:15672ï¼Œä½ ä¼šçœ‹åˆ°ä¸‹é¢çš„é¡µé¢:</p><figure class="ju jv jw jx fd ij er es paragraph-image"><a href="https://javarevisited.blogspot.com/2020/11/why-devops-engineer-learn-docker-kubernetes.html"><div class="er es jt"><img src="../Images/5acabb992b36a605cd6b81f109b1d5cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*t_OcFbxhYUOdHkJV"/></div></a></figure><p id="e02a" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">ä½¿ç”¨guest/guestä½œä¸ºç”¨æˆ·åå’Œå¯†ç ã€‚å¦‚æœæ‚¨æ­£åœ¨å°†rabbitmqéƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œé‚£ä¹ˆæ›´æ”¹é»˜è®¤å‡­è¯æ€»æ˜¯ä¸€ä¸ªå¥½ä¸»æ„ã€‚ä½†æ˜¯ç°åœ¨åº”è¯¥æ²¡äº‹äº†ã€‚</p><h1 id="5835" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">åœ¨Spring bootåº”ç”¨ç¨‹åºä¸­æ·»åŠ ä¾èµ–å…³ç³»</h1><p id="77a6" class="pw-post-body-paragraph iu iv hi iw b ix kw iz ja jb kx jd je jf ky jh ji jj kz jl jm jn la jp jq jr hb bi translated">è¦ä½¿ç”¨rabbitMQï¼Œæˆ‘ä»¬éœ€è¦æ·»åŠ <strong class="iw hj"> spring-boot-starter-amqp </strong>ä¾èµ–é¡¹ã€‚ç”±äºæˆ‘ä½¿ç”¨çš„æ˜¯mavenï¼Œæˆ‘å°†åœ¨pom.xmlä¸­æ·»åŠ ä»¥ä¸‹å†…å®¹:</p><pre class="ju jv jw jx fd lb lc ld le aw lf bi"><span id="4630" class="lg jz hi lc b fi lh li l lj lk">&lt;dependency&gt;<br/>   &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;<br/>   &lt;artifactId&gt;spring-boot-starter-amqp&lt;/artifactId&gt;<br/>&lt;/dependency&gt;</span></pre><p id="a880" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">æˆ‘è¿˜éœ€è¦åœ¨é…ç½®æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹é…ç½®:</p><pre class="ju jv jw jx fd lb lc ld le aw lf bi"><span id="c402" class="lg jz hi lc b fi lh li l lj lk">spring:<br/> rabbitmq:<br/>   host: localhost<br/>   port: 5672<br/>   username: guest<br/>   password: guest</span></pre><p id="92dc" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">ç°åœ¨spring amqpçŸ¥é“æˆ‘ä»¬çš„rabbitMQåœ¨å“ªé‡Œï¼Œä»¥åŠä½¿ç”¨å“ªä¸ªå‡­è¯æ¥è¿æ¥å®ƒã€‚</p><p id="851b" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">ä¸ºäº†è®©æˆ‘åœ¨è¿™é‡Œå±•ç¤ºçš„ä¾‹å­æœ‰å…³è”ï¼Œæˆ‘ä»¬è¦åšçš„æ˜¯ã€‚æˆ‘ä»¬å°†å…¬å¼€ä¸€ä¸ª<strong class="iw hj">ç”¨æˆ·æ³¨å†Œ</strong> <a class="ae js" href="https://javarevisited.blogspot.com/2021/09/how-to-return-different-http-status-from-sprnig-mvc-controller.html" rel="noopener ugc nofollow" target="_blank">æ§åˆ¶å™¨</a>ï¼Œæ¥æ”¶åŒ…å«å§“åã€ç”µå­é‚®ä»¶ç­‰çš„æœ‰æ•ˆè½½è·ï¼Œç„¶ååœ¨é˜Ÿåˆ—ä¸­å‘å¸ƒã€‚æˆ‘ä»¬å‡è®¾æ³¨å†Œä¸€ä¸ªç”¨æˆ·éœ€è¦è°ƒç”¨ä¸€äº›å…¶ä»–çš„æœåŠ¡å’Œ<a class="ae js" href="https://javarevisited.blogspot.com/2018/01/top-20-libraries-and-apis-for-java-programmers.html" rel="noopener ugc nofollow" target="_blank">API</a>ï¼Œæ‰€ä»¥æˆ‘ä»¬æŠŠå®ƒåšæˆå¼‚æ­¥çš„ï¼Œæ¶ˆè´¹è€…ä¼šåšæ‰€æœ‰è¿™äº›ã€‚</p><h1 id="ff01" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">å°†æ¶ˆæ¯å‘å¸ƒåˆ°é˜Ÿåˆ—</h1><p id="c76c" class="pw-post-body-paragraph iu iv hi iw b ix kw iz ja jb kx jd je jf ky jh ji jj kz jl jm jn la jp jq jr hb bi translated">ç°åœ¨æˆ‘å·²ç»åˆ›å»ºäº†ä¸€ä¸ªæ§åˆ¶å™¨ç±»ï¼Œå¹¶ä¸ºæ­¤æ·»åŠ äº†å…¶ä»–ç›¸å…³çš„ç±»ã€‚æ§åˆ¶å™¨çœ‹èµ·æ¥æ˜¯è¿™æ ·çš„:</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jt"><img src="../Images/903278411a2c17ff736f8db07b84af03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*BEaUjcXaL7EKBP-B"/></div></div></figure><p id="e264" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">æ³¨æ„ï¼Œæˆ‘å·²ç»åœ¨æ§åˆ¶å™¨ä¸­æ·»åŠ äº†RabbitTemplateï¼Œå¹¶åœ¨createUseræ–¹æ³•ä¸­ä½¿ç”¨å®ƒæ¥å‘å¸ƒæ¶ˆæ¯ã€‚ç°åœ¨æˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªé˜Ÿåˆ—ã€‚ä¸ºæ­¤ï¼Œæˆ‘ç™»å½•äº†rabbitMQç®¡ç†æ§åˆ¶å°ã€‚å¯¼èˆªåˆ°é˜Ÿåˆ—é€‰é¡¹å¡ï¼Œæœ‰ä¸€ä¸ª<strong class="iw hj">æ·»åŠ æ–°é˜Ÿåˆ—</strong>é€‰é¡¹ã€‚</p><figure class="ju jv jw jx fd ij er es paragraph-image"><a href="https://javarevisited.blogspot.com/2022/02/-stack-and-queue-data-structure-interview-questions.html"><div class="er es jt"><img src="../Images/169add82c7a50e4bb597154c8052fcb3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*VcXg09TeO6q_DhEV"/></div></a></figure><p id="789d" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">åªéœ€ä¿æŒå…¶ä»–å­—æ®µä¸ºé»˜è®¤ï¼Œå¹¶å°†åç§°è®¾ç½®ä¸º<strong class="iw hj">ç”¨æˆ·æ³¨å†Œ</strong>ã€‚</p><p id="f7b8" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">ç°åœ¨å¯åŠ¨åº”ç”¨ç¨‹åºï¼Œå¹¶ä½¿ç”¨é€‚å½“çš„æœ‰æ•ˆè´Ÿè½½è®¿é—®apiã€‚å¯¹æˆ‘æ¥è¯´æ˜¯è¿™æ ·çš„:</p><pre class="ju jv jw jx fd lb lc ld le aw lf bi"><span id="8651" class="lg jz hi lc b fi lh li l lj lk">curl --location --request POST 'http://localhost:8091/api/user' \</span><span id="34ed" class="lg jz hi lc b fi ll li l lj lk">--header 'Content-Type: application/json' \</span><span id="1f56" class="lg jz hi lc b fi ll li l lj lk">--data-raw '{</span><span id="4574" class="lg jz hi lc b fi ll li l lj lk">"username":"Johnson",</span><span id="1e75" class="lg jz hi lc b fi ll li l lj lk">"email":"johnsn@mail.com",</span><span id="8c37" class="lg jz hi lc b fi ll li l lj lk">"mobileNumber": "017000000111"</span><span id="bbe4" class="lg jz hi lc b fi ll li l lj lk">}'</span></pre><p id="f6a7" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">å¦‚æœä¸€åˆ‡æ­£å¸¸ï¼Œæˆ‘ä»¬å°†èƒ½å¤Ÿåœ¨é˜Ÿåˆ—ä¸­çœ‹åˆ°1æ¡å°±ç»ªæ¶ˆæ¯:</p><figure class="ju jv jw jx fd ij er es paragraph-image"><a href="https://javarevisited.blogspot.com/2020/02/top-5-postman-tutorials-and-courses-for-web-developers.html"><div class="er es jt"><img src="../Images/55024d3b75af8071b4b5e143b568e7cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*_DLNXE7AH4HUtcO3"/></div></a></figure><p id="f48a" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">è¦æŸ¥çœ‹æ¶ˆæ¯ï¼Œå•å‡»é˜Ÿåˆ—åç§°å¹¶ç‚¹å‡»è·å–<strong class="iw hj">æ¶ˆæ¯</strong>é€‰é¡¹ï¼Œå“¦ï¼æœ‰æ•ˆè´Ÿè½½ä¸å¯è¯»ã€‚å®ƒåœ¨base64 formaä¸­ã€‚æˆ‘ä¿è¯ç¨åæˆ‘ä»¬ä¼šå¤„ç†å®ƒã€‚ç°åœ¨å›åˆ°ç¼–ç ä¸Šæ¥ã€‚æˆ‘ç”¨è¿™å¥è¯å‘å¸ƒäº†æˆ‘çš„ä¿¡æ¯:</p><p id="665c" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">rabbitTemplate.convertAndSend("ï¼Œ"ç”¨æˆ·æ³¨å†Œ"ï¼Œè¯·æ±‚)ï¼›</p><p id="30ee" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">è¿™é‡Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯<strong class="iw hj">äº¤æ¢</strong>ï¼Œç¬¬äºŒä¸ªæ˜¯<strong class="iw hj">è·¯ç”±å…³é”®å­—</strong>ï¼Œæœ€åä¸€ä¸ªæ˜¯æœ‰æ•ˆè½½è·ã€‚ä½†æ˜¯é˜Ÿåˆ—åœ¨å“ªé‡Œå‘¢ï¼Ÿ</p><p id="af70" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">åœ¨rabbitMQä¸–ç•Œä¸­ï¼Œäº¤æ¢å°±åƒä¸€ä¸ªé‚®å±€ï¼Œé˜Ÿåˆ—å°±åƒç‰©ç†ä½ç½®ï¼Œè·¯ç”±å…³é”®å­—å°±æ˜¯è¯¥ä½ç½®çš„åœ°å€ã€‚å½“æˆ‘ä»¬åˆ›å»ºé˜Ÿåˆ—å¹¶ä¸”ä¸ä¸ä»»ä½•äº¤æ¢ç»‘å®šæ—¶ï¼Œé»˜è®¤çš„äº¤æ¢ä¼šè‡ªåŠ¨ä¸å®ƒç»‘å®šï¼Œå¹¶å°†è·¯ç”±å…³é”®å­—ä½œä¸ºé˜Ÿåˆ—çš„åç§°ã€‚è¿™ç§ä½¿ç”¨ç©ºå­—ç¬¦ä¸²å’Œé˜Ÿåˆ—åä½œä¸ºè·¯ç”±å…³é”®å­—çš„æ–¹æ³•å°†æ¶ˆæ¯å‘å¸ƒåˆ°é˜Ÿåˆ—ä¸­ã€‚ç”Ÿäº§è€…ä»ä¸ç›´æ¥å‘é˜Ÿåˆ—å‘é€æ¶ˆæ¯ã€‚</p><h1 id="6973" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">è‡ªåŠ¨åˆ›å»ºé˜Ÿåˆ—</h1><p id="acc2" class="pw-post-body-paragraph iu iv hi iw b ix kw iz ja jb kx jd je jf ky jh ji jj kz jl jm jn la jp jq jr hb bi translated">ç›®å‰ï¼Œé€šè¿‡ç®¡ç†æ§åˆ¶å°åˆ›å»ºå’Œé…ç½®é˜Ÿåˆ—å·¥ä½œæ­£å¸¸ã€‚ä½†åœ¨ç°å®ä¸–ç•Œä¸­ï¼Œè¿™å¹¶ä¸ç†æƒ³ã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œæœ‰10ä¸ªä¸åŒçš„é˜Ÿåˆ—ã€‚</p><p id="5047" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">æ¯å½“ä¸€ä¸ªæ–°çš„é˜Ÿå‹ä¸Šèˆ¹ï¼Œæˆ–è€…ä½ æ”¹å˜ä½ çš„è®¾å¤‡ï¼Œä½ éœ€è¦åˆ›å»ºé˜Ÿåˆ—ã€‚åº”ç”¨ç¨‹åºä»å¼€å‘ç¯å¢ƒè¿›å…¥æµ‹è¯•ç¯å¢ƒï¼Œæ‚¨éœ€è¦åˆ›å»ºé˜Ÿåˆ—ã€‚åº”ç”¨ç¨‹åºè¿›å…¥ç”Ÿäº§é˜¶æ®µï¼Œéœ€è¦æœ‰äººæ¥åˆ›å»ºå®ƒä»¬ã€‚è¿™å°†å˜å¾—ä¹å‘³ä¸”å®¹æ˜“å‡ºé”™ã€‚Spring AMQPä¸ºæˆ‘ä»¬æä¾›äº†rabbitMQ adminæ¥è‡ªåŠ¨åŒ–è¿™äº›ä»»åŠ¡ã€‚</p><p id="16ec" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">æœ€å¥½çš„éƒ¨åˆ†æ˜¯ï¼Œæ‚¨åªéœ€è¦åˆ›å»ºä¸€ä¸ªè¿”å›åŒ…å«é˜Ÿåˆ—åç§°çš„é˜Ÿåˆ—å¯¹è±¡çš„<a class="ae js" href="https://javarevisited.blogspot.com/2022/03/how-autowiring-of-beans-works-in-spring.html" rel="noopener ugc nofollow" target="_blank"> Bean </a>ã€‚å°†æ‰€æœ‰ä¸rabbitMQç›¸å…³çš„beansä¿å­˜åœ¨åŒä¸€ä¸ªé…ç½®æ–‡ä»¶ä¸­æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„åšæ³•ã€‚ç°åœ¨æˆ‘çš„RabbitMQConfigçœ‹èµ·æ¥åƒè¿™æ ·:</p><pre class="ju jv jw jx fd lb lc ld le aw lf bi"><span id="a3bb" class="lg jz hi lc b fi lh li l lj lk">@Configuration<br/>public class RabbitMQConfig {<br/>    @Bean<br/>    public Queue createUserRegistrationQueue() {<br/>        return new Queue("q.user-registration");<br/>    }<br/>}</span></pre><p id="49bc" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">ä»¥<strong class="iw hj"> q. </strong>å¼€å§‹å‘½åé˜Ÿåˆ—æ˜¯rabbitMQçš„æƒ¯ä¾‹ã€‚</p><p id="b505" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">ç»§ç»­æ“ä½œï¼Œä»ç®¡ç†é—¨æˆ·ä¸­åˆ é™¤ä»»ä½•ä»¥å‰çš„é˜Ÿåˆ—ï¼Œç„¶åé‡å¯åº”ç”¨ç¨‹åºå¹¶ç‚¹å‡»apiï¼Œåº”è¯¥ä¼šåˆ›å»ºé˜Ÿåˆ—å¹¶ä¼ é€’æ¶ˆæ¯ã€‚</p><h1 id="89a2" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">æ·»åŠ æ¶ˆè´¹è€…ä»¥å¤„ç†æ¶ˆæ¯</h1><p id="76cf" class="pw-post-body-paragraph iu iv hi iw b ix kw iz ja jb kx jd je jf ky jh ji jj kz jl jm jn la jp jq jr hb bi translated">å¦‚æœå‘å¸ƒçš„æ¶ˆæ¯æ²¡æœ‰æ¶ˆè´¹è€…ï¼Œé‚£ä¹ˆåªæœ‰å‘å¸ƒè€…ä¹Ÿåªæ˜¯ä¸€åŠçš„ä¹è¶£ã€‚æ‹¥æœ‰ä¸€ä¸ªæ¶ˆè´¹è€…å°±åƒç”¨<em class="lm"> @RabbitListener </em>æ³¨é‡Šä¸€ä¸ªæ–¹æ³•å¹¶æåˆ°é˜Ÿåˆ—ä¸€æ ·ç®€å•ã€‚æˆ‘çš„ç”¨æˆ·æ³¨å†Œè¯·æ±‚çœ‹èµ·æ¥åƒè¿™æ ·:</p><pre class="ju jv jw jx fd lb lc ld le aw lf bi"><span id="dcba" class="lg jz hi lc b fi lh li l lj lk">@Service<br/>@Slf4j<br/>public class UserRegistrationListener {<br/>          @RabbitListener(queues = {"q.user-registration"})<br/>    public void onUserRegistration(UserRegistrationRequest event) {<br/>            log.info("User Registration Event Received: {}", event);<br/>    }<br/>}</span></pre><p id="fcd9" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">å¦‚æœæ‚¨ç‚¹å‡»apiç«¯ç‚¹è¿›è¡Œæ³¨å†Œï¼Œç„¶åæ£€æŸ¥æ—¥å¿—ï¼Œæ‚¨å°†èƒ½å¤Ÿçœ‹åˆ°ä»¥ä¸‹å†…å®¹:</p><figure class="ju jv jw jx fd ij er es paragraph-image"><a href="https://javarevisited.blogspot.com/2021/04/top-5-tools-to-test-rest-apis-in-java.html#axzz7CGBoUS1n"><div class="er es jt"><img src="../Images/686c6900171b636ceb3867aee39c924a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*6qv2Nx7X556iI6bo"/></div></a></figure><p id="e750" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">çœ‹èµ·æ¥ä¸é”™ï¼æˆ‘åœ¨æ¶ˆè´¹è€…ä¸­æ¥æ”¶é¢„æœŸçš„æœ‰æ•ˆè½½è·ï¼ŒrabbitMQåœ¨å†…éƒ¨å¤„ç†åºåˆ—åŒ–å’Œååºåˆ—åŒ–ï¼Œè¿™æ ·æˆ‘å°±å¯ä»¥ä½¿ç”¨ä¸€ä¸ªæ¼‚äº®çš„javaå¯¹è±¡ã€‚ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬æƒ³ç›´æ¥ä»ç®¡ç†é—¨æˆ·æŸ¥çœ‹æ¶ˆæ¯ï¼Œæˆ‘ä»¬ä»ç„¶ä¼šçœ‹åˆ°base64æ ¼å¼çš„æ¶ˆæ¯ã€‚è¿™å¯¹äºå¼€å‘å’Œæ•…éšœæ’é™¤æ¥è¯´å¹¶ä¸ç†æƒ³ã€‚æˆ‘ä»¬å¸Œæœ›çœ‹åˆ°äººç±»å¯è¯»æ ¼å¼çš„ä¿¡æ¯ã€‚</p><p id="f372" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">ä¸ºäº†å®ç°è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬éœ€è¦å£°æ˜ä¸€ä¸ª<strong class="iw hj">Jackson 2 jsonmessageconverter</strong>beanï¼Œå¹¶å°†å…¶è®¾ç½®ä¸ºrabbitTemplateä¸­éœ€è¦è½¬æ¢çš„æ¶ˆæ¯ã€‚éœ€è¦åœ¨æˆ‘ä»¬çš„RabitMQConfigæ–‡ä»¶ä¸­æ·»åŠ è¿™äº›beans:</p><figure class="ju jv jw jx fd ij er es paragraph-image"><a href="https://javarevisited.blogspot.com/2022/03/3-examples-to-parse-json-in-java-using.html"><div class="er es jt"><img src="../Images/8657caead4ddfef9dbd9f7930e5446bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*HiGLQbBaHxbgtCMf"/></div></a></figure><p id="ae15" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">æ³¨æ„ï¼Œæˆ‘ä»¬åœ¨æ„é€ rabbitTemplateæ—¶ä½¿ç”¨äº†é»˜è®¤çš„cachingConnectionFactoryã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡æ„é€ å‡½æ•°æ³¨å…¥cachingConnectionFactoryã€‚ä¹‹åï¼Œæ³¨é‡Šæ‰ä¾¦å¬å™¨ä»¥æ£€æŸ¥é—¨æˆ·ä¸­çš„æ¶ˆæ¯ã€‚å¦åˆ™ï¼Œå®ƒå°†åœ¨æˆ‘ä»¬æœ‰æœºä¼šçœ‹åˆ°ä¹‹å‰å°±åœ¨æ¶ˆè´¹è€…æ–¹æ³•ä¸­è¢«äº¤ä»˜ã€‚</p><p id="8ee6" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">å¦‚æœæˆ‘ä»¬ç°åœ¨ç‚¹å‡»apiï¼Œå¹¶æ£€æŸ¥é˜Ÿåˆ—ï¼Œæˆ‘ä»¬å°†èƒ½å¤Ÿä»ç®¡ç†é—¨æˆ·çœ‹åˆ°æœ‰æ•ˆè´Ÿè½½çš„æ–‡æœ¬ã€‚</p><figure class="ju jv jw jx fd ij er es paragraph-image"><a href="https://javarevisited.blogspot.com/2020/04/top-5-courses-to-learn-java-collections-and-streams.html"><div class="er es jt"><img src="../Images/87033a3faa28722b21edf39d99dff823.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*xmwX3IsJ5KrDoVYn"/></div></a></figure><h1 id="6213" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">æ³¨å†Œåé€šè¿‡ç”µå­é‚®ä»¶å’ŒçŸ­ä¿¡é€šçŸ¥ç”¨æˆ·</h1><p id="1d91" class="pw-post-body-paragraph iu iv hi iw b ix kw iz ja jb kx jd je jf ky jh ji jj kz jl jm jn la jp jq jr hb bi translated">å‡è®¾åœ¨å®Œæˆç”¨æˆ·æ³¨å†Œåï¼Œæˆ‘ä»¬æƒ³é€šè¿‡ç”µå­é‚®ä»¶å’ŒçŸ­ä¿¡é€šçŸ¥ç”¨æˆ·ã€‚å½“ç„¶ï¼Œæˆ‘ä»¬å¯ä»¥ç¼–å†™ç›¸åº”çš„æœåŠ¡ï¼Œå¹¶åœ¨æ³¨å†Œåè°ƒç”¨å®ƒä»¬ã€‚é‚£ä¹ˆæˆ‘ä»¬çš„ä»£ç å¯èƒ½å¦‚ä¸‹æ‰€ç¤º:</p><pre class="ju jv jw jx fd lb lc ld le aw lf bi"><span id="211c" class="lg jz hi lc b fi lh li l lj lk">@RabbitListener(queues = {"q.user-registration"})<br/>public void onUserRegistration(UserRegistrationRequest event) {<br/><br/>        log.info("User Registration Event Received: {}", event);<br/><br/>        /*<br/>        Relevant business logic for user registration<br/>        */<br/><br/>        emailService.sendEmail(event.getEmail());<br/>        smsService.sendSms(event.getMobileNumber());<br/><br/>}</span></pre><p id="d32c" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">ä½†æ˜¯è¿™ç§æ–¹æ³•å­˜åœ¨ä¸€äº›é—®é¢˜ã€‚æ‚¨çš„é€šçŸ¥ç³»ç»Ÿä¸æ³¨å†Œç³»ç»Ÿç´§å¯†ç»“åˆåœ¨ä¸€èµ·ã€‚å¦‚æœå¤„ç†ä¸å½“ï¼ŒsenEmailæ–¹æ³•ä¸­çš„å¼‚å¸¸ä¹Ÿå¯èƒ½ä¼šä¸­æ–­smsä¼ é€’ã€‚æ‚¨å¯èƒ½ä¸å¸Œæœ›å°†æ‰§è¡Œç”¨æˆ·æ³¨å†Œç­‰ç¹é‡ä»»åŠ¡çš„åŒä¸€åº”ç”¨ç¨‹åºçš„è®¡ç®—èµ„æºç”¨äºå‘é€ç”µå­é‚®ä»¶ç­‰è½»é‡çº§ä»»åŠ¡ã€‚æˆ‘ä»¬åœ¨è¿™é‡Œèƒ½åšä»€ä¹ˆï¼Ÿå…”å­æ¥äº†ã€‚</p><p id="b589" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">æˆ‘ä»¬å°†åˆ›å»ºä¸¤ä¸ªé˜Ÿåˆ—ï¼Œç”¨RabbitListeneræ³¨é‡Šæˆ‘ä»¬çš„æ–¹æ³•ï¼Œæåˆ°æŒ‡å®šçš„é˜Ÿåˆ—ã€‚ç„¶åï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ç§ç‰¹æ®Šç±»å‹çš„äº¤æ¢ï¼Œç§°ä¸ºæ‰‡å‡ºäº¤æ¢ï¼Œä»¥ç»‘å®šé˜Ÿåˆ—ã€‚è¿™ä¸ªäº¤æ¢çš„ç‰¹ç‚¹æ˜¯:ä¸ç®¡è·¯ç”±å…³é”®å­—æ˜¯ä»€ä¹ˆï¼Œç»‘å®šåˆ°è¿™ä¸ªäº¤æ¢çš„æ¯ä¸ªé˜Ÿåˆ—éƒ½æ¥æ”¶æ¶ˆæ¯ã€‚</p><p id="da92" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">æˆ‘ä»¬éœ€è¦åœ¨rabbitMQé…ç½®ä¸­æ·»åŠ ä»¥ä¸‹Beanã€‚</p><pre class="ju jv jw jx fd lb lc ld le aw lf bi"><span id="0d3d" class="lg jz hi lc b fi lh li l lj lk">@Bean<br/>public Declarables createPostRegistartionSchema(){<br/>        <br/>return new Declarables(<br/>                new FanoutExchange("x.post-registration"),<br/>                new Queue("q.send-email" ),<br/>                new Queue("q.send-sms"),<br/>                new Binding("q.send-email", Binding.DestinationType.QUEUE, "x.post-registration", "send-email", null),<br/>                new Binding("q.send-sms", Binding.DestinationType.QUEUE, "x.post-registration", "send-sms", null));<br/>    <br/>}</span></pre><p id="4176" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">åœ¨è¿™é‡Œçš„ç¬¬ä¸€è¡Œï¼Œæˆ‘ä»¬å£°æ˜äº¤æ¢ï¼ŒæŒ‰ç…§æƒ¯ä¾‹äº¤æ¢çš„åå­—ä»¥xå¼€å¤´ã€‚</p><p id="197f" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">åœ¨æ¥ä¸‹æ¥çš„ä¸¤è¡Œä¸­ï¼Œæˆ‘ä»¬å£°æ˜äº†é˜Ÿåˆ—ã€‚ç„¶ååœ¨æœ€åä¸¤è¡Œä¸­ï¼Œæˆ‘ä»¬ç”¨è¿™ä¸ª<em class="lm"> x.post-registration </em>äº¤æ¢å£°æ˜äº†é˜Ÿåˆ—çš„ç»‘å®šã€‚</p><p id="9c72" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">é‡å¯åº”ç”¨ç¨‹åºåï¼Œè½¬åˆ°ç®¡ç†é—¨æˆ·çš„<strong class="iw hj">äº¤æ˜“æ‰€</strong>é€‰é¡¹å¡ï¼Œæ‚¨ä¼šçœ‹åˆ°æœ‰ä¸€ä¸ªä»¥æˆ‘ä»¬ç»™å®šçš„åç§°åˆ›å»ºçš„äº¤æ˜“æ‰€ä»¥åŠå…¶ä»–äº¤æ˜“æ‰€ã€‚</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ln"><img src="../Images/b76463885ff5a75489867b3086e5abbe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*kVl8hGR7WvOnI9m2"/></div></div></figure><p id="a701" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">ç‚¹å‡»å®ƒï¼Œä½ ä¼šçœ‹åˆ°ç»‘å®š:</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ln"><img src="../Images/5756682c342b86ec8c5f7974f222dae2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*cZaDclUvLCPATG36"/></div></div></figure><p id="190c" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">ç°åœ¨æˆ‘æ·»åŠ äº†ä¸¤ä¸ªæ¶ˆè´¹è€…ï¼Œä¸€ä¸ªç”¨äºçŸ­ä¿¡ï¼Œä¸€ä¸ªç”¨äºé‚®ä»¶:</p><pre class="ju jv jw jx fd lb lc ld le aw lf bi"><span id="eea2" class="lg jz hi lc b fi lh li l lj lk">@Service<br/>@Slf4j<br/>public class SendSmsService {<br/>    @RabbitListener(queues = "q.send-sms")<br/>    public void sendSms(UserRegistrationRequest request) {<br/><br/>        log.info("Sending sms to {} ", request.getMobileNumber());<br/>    }<br/>}<br/>--------------------------------------------------------------------<br/>@Service<br/>@Slf4j<br/>public class SendEmailService {<br/><br/>    @RabbitListener(queues = "q.send-email")<br/>    public void sendEmail(UserRegistrationRequest request) {<br/>        <br/>        log.info("Sending email to {}", request.getEmail());<br/>    }<br/>}</span></pre><p id="a8cf" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">æœ€åï¼Œåœ¨userRegistrationListenerä¸­æ·»åŠ ä»¥ä¸‹è¡Œ:</p><p id="1bdc" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">rabbit template . convertandsend(" x . post-registration "ï¼Œ""ï¼Œevent)ï¼›</p><p id="ba8c" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">ç„¶åé‡æ–°å¯åŠ¨åº”ç”¨ç¨‹åºå¹¶ç‚¹å‡»apiï¼Œåº”è¯¥å¯ä»¥çœ‹åˆ°ä»¥ä¸‹æ—¥å¿—:</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jt"><img src="../Images/4c4ec3487555da9e9e7b710dd0186f29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*73CFmrD5SKVWWpxc"/></div></div></figure><p id="b8a0" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">é…·å§ï¼Ÿæäº¤ä¸€æ¬¡å¹¶åœ¨å¤šä¸ªæ¶ˆè´¹è€…ä¸­æ¥æ”¶ã€‚ç°åœ¨ï¼Œè¿™äº›çœ‹èµ·æ¥å·²ç»æ­£ç¡®è§£è€¦äº†ã€‚</p><h1 id="a1f2" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">å¯ç”¨æ­£å¸¸é‡è¯•æœºåˆ¶</h1><p id="5ccb" class="pw-post-body-paragraph iu iv hi iw b ix kw iz ja jb kx jd je jf ky jh ji jj kz jl jm jn la jp jq jr hb bi translated">å¦‚å‰æ‰€è¿°ï¼Œæ³¨å†Œç”¨æˆ·æ˜¯ä¸€ä¸ªæå…¶å¤æ‚çš„è¿‡ç¨‹ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¯èƒ½ä¼šå¼•å‘ä¸€äº›å¼‚å¸¸ï¼Œå¯¹äºè¿™äº›å¼‚å¸¸ï¼Œé‡è¯•å¯èƒ½æ˜¯ä¸€ä¸ªå¥½çš„é€‰æ‹©ã€‚æ‚¨å¯ä»¥é€šè¿‡æŠ›å‡ºè¯¥å¼‚å¸¸æ¥è§£å†³é‡è¯•rabbitMQçš„é—®é¢˜ã€‚è®©æˆ‘ä»¬æ¨¡æ‹Ÿä¸€ä¸‹è¿™ä¸ªåœºæ™¯:</p><pre class="ju jv jw jx fd lb lc ld le aw lf bi"><span id="6eb0" class="lg jz hi lc b fi lh li l lj lk">@RabbitListener(queues = {"q.user-registration"})<br/>public void onUserRegistration(UserRegistrationRequest event)  {<br/>    log.info("User Registration Event Received: {}", event);<br/><br/>    executeRegistration(event);<br/><br/><br/>    rabbitTemplate.convertAndSend("x.post-registration","", event);<br/>}<br/><br/>private void executeRegistration(UserRegistrationRequest event) {<br/>    log.info("Executing User Registration Event: {}", event);<br/><br/>    throw new RuntimeException("Registration Failed");<br/><br/>}</span></pre><p id="dae2" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">æˆ‘ä»¬ä»ä¾¦å¬å™¨ä¸­è°ƒç”¨<strong class="iw hj"> executeRegistration </strong>æ–¹æ³•ï¼Œåœ¨è¿™ä¸ªæ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬ç”Ÿæˆä¸€ä¸ªRunTimeExceptionã€‚ç°åœ¨é‡å¯åº”ç”¨ç¨‹åºå¹¶ç‚¹å‡»apiã€‚å“‡ï¼æ­£åœ¨é‡è¯•â€¦é—®é¢˜å·²è§£å†³ï¼ä½†æ˜¯ç­‰ç­‰â€¦..å®ƒä¼šé‡è¯•å¤šé•¿æ—¶é—´ï¼Ÿç›´åˆ°ä¾‹å¤–æ¶ˆå¤±ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥æ›´æ”¹ä»£ç å¹¶é‡å¯ï¼Œä½†åœ¨ç°å®ä¸–ç•Œä¸­è¿™æ˜¯ä¸å¯èƒ½çš„ã€‚å¦‚æœå¼‚å¸¸æŒç»­å‘ç”Ÿï¼Œæˆ‘ä»¬éœ€è¦åœ¨æŸä¸ªç‚¹åœæ­¢ï¼Œå¹¶åœ¨ä¸¤æ¬¡å°è¯•ä¹‹é—´ç­‰å¾…ã€‚ä½ æ³¨æ„åˆ°äº†å—ï¼Œç°åœ¨é‡è¯•å¤ªå¿«äº†ï¼Ÿ</p><p id="bcd3" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦å£°æ˜ä¸¤ä¸ªbeansã€‚ä¸€ä¸ª<strong class="iw hj">SimpleRabbitListenerContainerFactory</strong>å’Œå¦ä¸€ä¸ª<strong class="iw hj">retryoperations interceptor</strong>ã€‚ç„¶åå°†è¿™ä¸ªæ‹¦æˆªå™¨æ·»åŠ åˆ°listenerContainerFactoryçš„é€šçŸ¥é“¾ä¸­ã€‚</p><pre class="ju jv jw jx fd lb lc ld le aw lf bi"><span id="7a29" class="lg jz hi lc b fi lh li l lj lk">@Bean<br/>public RetryOperationsInterceptor retryInterceptor(){<br/>    return RetryInterceptorBuilder.stateless().maxAttempts(3)<br/>            .backOffOptions(2000, 2.0, 100000)<br/>            .build();<br/>}<br/><br/><br/>@Bean<br/>public SimpleRabbitListenerContainerFactory rabbitListenerContainerFactory(SimpleRabbitListenerContainerFactoryConfigurer configurer) {<br/>    SimpleRabbitListenerContainerFactory factory = new SimpleRabbitListenerContainerFactory();<br/>    configurer.configure(factory, cachingConnectionFactory);<br/>    factory.setAcknowledgeMode(AcknowledgeMode.AUTO);<br/>    factory.setAdviceChain(retryInterceptor());<br/>    return factory;<br/>}</span></pre><p id="43a5" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">ç°åœ¨é‡å¯åº”ç”¨ç¨‹åºå¹¶ç‚¹å‡»apiã€‚å®ƒåº”è¯¥åªåœ¨åˆæ¬¡å°è¯•åé‡è¯•2æ¬¡ã€‚ä¸¤ç§’åç¬¬ä¸€æ¬¡ï¼Œå››ç§’åç¬¬äºŒæ¬¡ã€‚</p><p id="8935" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">è¿™é‡Œæœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå‘½åbean<strong class="iw hj">rabbitListenerContainerFactory</strong>è¦†ç›–é»˜è®¤çš„ç›‘å¬å™¨å®¹å™¨å·¥å‚ã€‚å› æ­¤ï¼Œè¿™ä¸ªé‡è¯•æœºåˆ¶å°†ä¸ºæ‰€æœ‰ä¾¦å¬å™¨æ¿€æ´»ã€‚å¦‚æœæ‚¨ä¸å¸Œæœ›è¿™æ ·ï¼Œå¹¶ä¸”å¸Œæœ›è¿™ç§æœºåˆ¶ä»…ç”¨äºUserRegistrationListenerï¼Œè¯·æ‰§è¡Œä»¥ä¸‹æ“ä½œã€‚å°†å·¥å‚é‡å‘½åä¸ºå…¶ä»–åç§°..like:registrationListenerContainerFactoryç„¶ååœ¨RabbitListeneræ³¨é‡Šè¡Œä¸­æåˆ°å®ƒ:</p><pre class="ju jv jw jx fd lb lc ld le aw lf bi"><span id="8727" class="lg jz hi lc b fi lh li l lj lk">@RabbitListener(queues = {"q.user-registration"}, containerFactory = "registrationListenerContainerFactory")</span></pre><p id="7c91" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">è¯·æ³¨æ„ï¼Œåœ¨é‡è¯•ç¨‹åºè€—å°½ä¹‹åï¼Œæ¶ˆæ¯å°†è¢«ä¸¢å¼ƒã€‚å› æ­¤ï¼Œå¦‚æœåœ¨é‡è¯•è¿‡ç¨‹ä¸­ä¸æ–­å‡ºç°å¼‚å¸¸ï¼Œæ¶ˆæ¯å°†ä¼šä¸¢å¤±ã€‚å¯¹äºè®¸å¤šæƒ…å†µæ¥è¯´ï¼Œè¿™å¯èƒ½ä¸æ˜¯ç†æƒ³çš„æƒ…å†µã€‚æˆ‘ä»¬å¯èƒ½å¸Œæœ›è·Ÿè¸ªæ•…éšœï¼Œä»¥ä¾¿å°†æ¥è¿›è¡Œè¿›ä¸€æ­¥çš„å¤„ç†æˆ–è°ƒæŸ¥ã€‚</p><h1 id="1be9" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">ä¸ºå¤±è´¥çš„æ³¨å†Œæ·»åŠ æ­»ä¿¡é˜Ÿåˆ—</h1><p id="e287" class="pw-post-body-paragraph iu iv hi iw b ix kw iz ja jb kx jd je jf ky jh ji jj kz jl jm jn la jp jq jr hb bi translated">æ­»ä¿¡é˜Ÿåˆ—åªæ˜¯å¦ä¸€ä¸ªé˜Ÿåˆ—ï¼Œå®ƒçš„ç‰¹åˆ«ä¹‹å¤„åœ¨äºæˆ‘ä»¬ä½•æ—¶æˆ–å¦‚ä½•ä½¿ç”¨å®ƒã€‚é¦–å…ˆï¼Œæˆ‘ä»¬å°†ä¸ºæ­¤å£°æ˜ä¸€ä¸ªæ¨¡å¼ã€‚</p><pre class="ju jv jw jx fd lb lc ld le aw lf bi"><span id="eec1" class="lg jz hi lc b fi lh li l lj lk">@Bean<br/>public Declarables createDeadLetterSchema(){<br/>    return new Declarables(<br/>        new DirectExchange("x.registration-failure"),<br/>        new Queue("q.fall-back-registration"),<br/>        new Binding("q.fall-back-registration", Binding.DestinationType.QUEUE,"x.registration-failure", "fall-back", null)<br/>    );<br/>}</span></pre><p id="473c" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">åªæ˜¯ä¸€ä¸ªæ­£å¸¸çš„äº¤æ¢ï¼Œé˜Ÿåˆ—å’Œå®ƒä»¬çš„ç»‘å®šã€‚æˆ‘å·²ç»å°†è·¯ç”±é”®è®¾ç½®ä¸ºâ€œfall-back â€,ç¨åä¼šç”¨åˆ°å®ƒã€‚</p><p id="1e74" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">ç°åœ¨æˆ‘ä»¬å°†é…ç½®æˆ‘ä»¬çš„<strong class="iw hj"> q.user-registration </strong>ï¼Œä»¥ä¾¿å®ƒçŸ¥é“å®ƒæœ‰ä¸€ä¸ªæ­»ä¿¡é˜Ÿåˆ—ã€‚æœ€å¥½åˆ é™¤ä¹‹å‰çš„é˜Ÿåˆ—ã€‚å¦åˆ™æ›´æ–°çš„é…ç½®å¯èƒ½ä¸ä¼šåæ˜ ã€‚</p><pre class="ju jv jw jx fd lb lc ld le aw lf bi"><span id="cd66" class="lg jz hi lc b fi lh li l lj lk">@Bean<br/>public Queue createUserRegistrationQueue() {<br/><br/>    return QueueBuilder.durable("q.user-registration")<br/>        .withArgument("x-dead-letter-exchange","x.registration-failure")<br/>        .withArgument("x-dead-letter-routing-key","fall-back")<br/>        .build();<br/>}</span></pre><p id="a061" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">è¿™é‡Œæˆ‘ä»¬ç”¨æ­»ä¿¡é…ç½®å£°æ˜äº†é˜Ÿåˆ—ã€‚è¿™é‡Œçš„è®ºç‚¹æ˜¯ä¸è¨€è‡ªæ˜çš„ã€‚</p><p id="7184" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">æ‹¼å›¾çš„æœ€åä¸€å—ã€‚ä¸ºäº†ç¡®ä¿rabbitMQå°†æ¶ˆæ¯ä¼ è¾¾ç»™DLXï¼Œæˆ‘ä»¬éœ€è¦ä»ä¾¦å¬å™¨ä¸­æŠ›å‡ºä¸€ä¸ª<strong class="iw hj">amqprechectanddontrequeueexception</strong>ã€‚ä½†æ˜¯æˆ‘ä»¬ä¸èƒ½ç°åœ¨å°±æ‰”æ‰å®ƒï¼Œå› ä¸ºæˆ‘ä»¬æ­£åœ¨ä½¿ç”¨ä¸€ä¸ªé‡è¯•æ‹¦æˆªå™¨ã€‚ç›¸åï¼Œæˆ‘ä»¬å°†å‘Šè¯‰é‡è¯•æ‹¦æˆªå™¨åœ¨ç”¨å°½æ—¶æŠ›å‡ºè¿™ä¸ªå¼‚å¸¸ã€‚åƒè¿™æ ·:</p><pre class="ju jv jw jx fd lb lc ld le aw lf bi"><span id="e9b4" class="lg jz hi lc b fi lh li l lj lk">@Bean<br/>public RetryOperationsInterceptor retryInterceptor(){<br/>    return RetryInterceptorBuilder.stateless().maxAttempts(3)<br/>            .backOffOptions(2000, 2.0, 100000)<br/>            .recoverer(new RejectAndDontRequeueRecoverer())<br/>            .build();<br/>}</span></pre><p id="91c0" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">ç°åœ¨ï¼Œæˆ‘ä»¬å¿…é¡»æ·»åŠ ä¸€ä¸ªä¾¦å¬å™¨æ¥æ¥æ”¶é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯:</p><pre class="ju jv jw jx fd lb lc ld le aw lf bi"><span id="492c" class="lg jz hi lc b fi lh li l lj lk">@Service<br/>@Slf4j<br/>public class FallBackRegistrationService {<br/><br/>    @RabbitListener(queues = {"q.fall-back-registration"})<br/>    public void onRegistrationFailure(UserRegistrationRequest failedRegistration){<br/>        log.info("Executing fallback for failed registration {}", failedRegistration);<br/>  }<br/><br/>}</span></pre><p id="dff1" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">ç°åœ¨é‡å¯åº”ç”¨ç¨‹åºå¹¶æ£€æŸ¥æ—¥å¿—ã€‚åœ¨é‡è¯•å°è¯•çš„æ¡ç›®ä¹‹åï¼Œå°†ä¼šå‡ºç°å¦‚ä¸‹æ–°è¡Œ:</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jt"><img src="../Images/6f12093f8d7203b85d3ea091b5cb322a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7Lx8yV2GbnWMqxy6"/></div></div></figure><p id="32dc" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">ç°åœ¨å°±çœ‹ä½ æƒ³åœ¨è¿™é‡Œåšä»€ä¹ˆäº†ã€‚æ‚¨å¯ä»¥å°†å®ƒä¿å­˜åœ¨æ•°æ®åº“ä¸­ï¼Œè°ƒç”¨å…¶ä»–æœåŠ¡ï¼Œæˆ–è€…åœ¨å¦ä¸€ä¸ªé˜Ÿåˆ—ä¸­é‡æ–°æ’é˜Ÿã€‚</p><h1 id="61c1" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">æ·»åŠ åˆ†å¸ƒå¼è·Ÿè¸ª</h1><p id="3725" class="pw-post-body-paragraph iu iv hi iw b ix kw iz ja jb kx jd je jf ky jh ji jj kz jl jm jn la jp jq jr hb bi translated">è¿™æ˜¯æœ€ç®€å•çš„éƒ¨åˆ†ã€‚åªéœ€åœ¨æ‚¨çš„ä¾èµ–é¡¹ä¸­æ·»åŠ sleuthï¼Œæ‚¨å°†çœ‹åˆ°è·Ÿè¸ªidåœ¨æ‰€æœ‰æ—¥å¿—ä¸­ä¼ æ’­ã€‚</p><pre class="ju jv jw jx fd lb lc ld le aw lf bi"><span id="46e1" class="lg jz hi lc b fi lh li l lj lk">&lt;dependency&gt;<br/>    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;<br/>    &lt;artifactId&gt;spring-cloud-starter-sleuth&lt;/artifactId&gt;<br/>&lt;/dependency&gt;</span></pre><p id="6bbe" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">å¦‚æœæ¶‰åŠä¸åŒçš„åº”ç”¨ç¨‹åºæˆ–å¾®æœåŠ¡ï¼Œè¿™å°¤å…¶æœ‰ç”¨ã€‚</p><p id="e2b0" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">ä»Šå¤©åˆ°æ­¤ä¸ºæ­¢ã€‚</p><p id="ee6e" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">è¿™ä¸ªæ¼”ç¤ºçš„æ‰€æœ‰ä»£ç éƒ½å¯ä»¥åœ¨<a class="ae js" href="https://github.com/Ruhshan/rabbitmq-spring-demo" rel="noopener ugc nofollow" target="_blank">è¿™é‡Œ</a>è·å¾—ã€‚</p></div><div class="ab cl lo lp gp lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="hb hc hd he hf"><p id="16d0" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">æ”¯æŒæˆ‘ğŸ‘‡</p><figure class="ju jv jw jx fd ij er es paragraph-image"><a href="https://www.buymeacoffee.com/ruhshan"><div class="er es lv"><img src="../Images/3fa25c02bfae703b847436bfda7ce946.png" data-original-src="https://miro.medium.com/v2/resize:fit:1090/format:webp/1*7Pq-C6d0si0t4vv-j8TGqg.png"/></div></a></figure></div></div>    
</body>
</html>